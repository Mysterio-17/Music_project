<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <title>Lobby Room</title>
Â  <script src="/socket.io/socket.io.js"></script>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  </head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center h-screen">
Â  <h1 class="text-2xl font-bold mb-4">ğŸµ Lobby Room</h1>
Â  <p id="roomCode" class="mb-2 text-yellow-300 font-semibold"></p>

Â  <ul id="playersUl" class="list-disc mb-6"></ul>
Â  <input id="playlistInput" type="text" placeholder="Paste YouTube Playlist URL"
Â  Â  class="w-full px-4 py-2 mb-4 rounded-md text-black max-w-md" />

Â  <button id="loadPlaylistBtn"
Â  Â  class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded mb-4">
Â  Â  ğŸ¶ Load Playlist
Â  </button>

Â  <button id="startGameBtn" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded hidden">
Â  Â  â–¶ï¸ Start Game
Â  </button>

Â  Â  <script>
Â  Â  const socket = io();

Â  Â  const urlParams = new URLSearchParams(window.location.search);
Â  Â  const roomCode = urlParams.get("room");
Â  Â  const isHost = urlParams.get("host") === "true";
Â  Â  const username = urlParams.get("username");

Â  Â  socket.emit("joinRoom", { username, room: roomCode });
Â  Â  document.getElementById("roomCode").innerText = `Room Code: ${roomCode}`;

Â  Â  if (isHost) {
Â  Â  Â  document.getElementById("startGameBtn").classList.remove("hidden");
Â  Â  }

Â  Â  document.getElementById("startGameBtn").onclick = () => {
Â  Â  Â  socket.emit("startGame", { roomCode: roomCode });
Â  Â  Â  console.log("ğŸš€ startGame emitted to server");
Â  Â  };

Â  Â  document.getElementById("loadPlaylistBtn").onclick = () => {
  console.log("ğŸ¬ loadPlaylist clicked");
Â  Â  Â  const url = document.getElementById("playlistInput").value.trim();
Â  Â  Â  if (!url) return alert("Paste a playlist URL");
Â  Â  Â  const playlistId = extractPlaylistId(url);
Â  Â  Â  if (!playlistId) return alert("Invalid playlist URL");
Â  Â  Â  socket.emit("loadPlaylist", { playlistId, room: roomCode });
Â  Â  };

Â  Â  socket.on("gameStarted", () => {
Â  Â  Â  console.log("Game started! Redirecting to game.html");
Â  Â  Â  window.location.href = `/game.html?room=${roomCode}&username=${username}`;
Â  Â  });

Â  Â  function extractPlaylistId(url) {
Â  Â  Â  const match = url.match(/[?&]list=([a-zA-Z0-9_-]+)/);
Â  Â  Â  return match ? match[1] : null;
Â  Â  }

Â  Â  socket.on("updatePlayers", (usernames) => {
Â  Â  Â  const playersUl = document.getElementById("playersUl");
Â  Â  Â  playersUl.innerHTML = '';
Â  Â  Â  usernames.forEach(name => {
Â  Â  Â  Â  const li = document.createElement("li");
Â  Â  Â  Â  li.textContent = name;
Â  Â  Â  Â  playersUl.appendChild(li);
Â  Â  Â  });
Â  Â  });

Â  Â  socket.on("roundEnd", (scores) => {
Â  Â  Â  alert("Round over! Check leaderboard.");
Â  Â  });
Â  </script>
</body>
</html>